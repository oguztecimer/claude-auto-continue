---
phase: 07-pre-publish-verification
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: []
autonomous: false
requirements: [PUBL-01]

must_haves:
  truths:
    - "All 91 tests pass with exit code 0"
    - "npm pack --dry-run shows dist/ and bin/ in tarball, no node_modules/"
    - "Package version is 1.0.0 and README.md is included in tarball"
    - "node dist/cli.js --help prints usage text and exits cleanly"
    - "npm whoami returns a valid npm username"
  artifacts: []
  key_links: []
---

<objective>
Run the complete pre-publish verification checklist to confirm the package is ready for npm publish.

Purpose: Gate phase 8 (publish) by verifying tests pass, tarball contents are correct, CLI binary works, and npm authentication is configured.
Output: All four success criteria verified. No files created or modified â€” verification only.
</objective>

<execution_context>
@/Users/dakmor/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dakmor/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run test suite and build</name>
  <files>dist/</files>
  <action>
Run the full test suite and build to ensure everything is current:

1. Run `npm test` and verify all 91 tests pass across 8 test files with exit code 0
2. Run `npm run build` to ensure dist/ is freshly compiled from current source
3. Verify dist/ contains the expected compiled files (cli.js, PatternDetector.js, ProcessSupervisor.js, CountdownCard.js, StatusBar.js, Scheduler.js, StdinWriter.js, ansi.js, config.js plus their .d.ts and .js.map files)

If tests fail: report the failures and stop. Do not proceed to Task 2.
If build fails: report the TypeScript errors and stop.
  </action>
  <verify>
    <automated>npm test && npm run build && ls dist/*.js | wc -l</automated>
  </verify>
  <done>All 91 tests pass. Build succeeds. dist/ contains 9 .js files freshly compiled.</done>
</task>

<task type="auto">
  <name>Task 2: Verify tarball contents with npm pack --dry-run</name>
  <files></files>
  <action>
Run `npm pack --dry-run` and verify the tarball contents meet all criteria:

1. **dist/ present:** Tarball includes dist/*.js, dist/*.d.ts, dist/*.js.map files
2. **bin/ present:** Tarball includes bin/claude-auto-continue.js
3. **No node_modules/:** node_modules/ must NOT appear in tarball listing
4. **No test files:** test/ directory must NOT appear in tarball listing
5. **No source files:** src/ directory must NOT appear in tarball listing
6. **Version 1.0.0:** Package name line shows claude-auto-continue@1.0.0
7. **README.md included:** README.md appears in tarball file list
8. **LICENSE included:** LICENSE appears in tarball file list

Expected: 31 files total. Package size ~19 kB.

If any check fails: report which criterion failed and the actual tarball output.
  </action>
  <verify>
    <automated>npm pack --dry-run 2>&1 | grep -E "claude-auto-continue@1.0.0|README.md|LICENSE|bin/|dist/" | head -20</automated>
  </verify>
  <done>Tarball contains exactly the right files: dist/, bin/, LICENSE, README.md, package.json. No unwanted files (node_modules/, test/, src/). Version is 1.0.0.</done>
</task>

<task type="auto">
  <name>Task 3: Test CLI binary execution</name>
  <files></files>
  <action>
Verify the CLI binary entry point works correctly:

1. Run `node dist/cli.js --help` and verify it prints usage text including:
   - Package name and version (claude-auto-continue v1.0.0)
   - USAGE section with command syntax
   - OPTIONS section with --help and --version flags
   - EXAMPLES section
   - WHAT IT DOES section
2. Verify exit code is 0
3. Run `node dist/cli.js --version` and verify it prints "1.0.0"
4. Verify `bin/claude-auto-continue.js` has a proper shebang line (#!/usr/bin/env node) and requires dist/cli.js

If the CLI fails to execute: report the error output.
  </action>
  <verify>
    <automated>node dist/cli.js --help && node dist/cli.js --version</automated>
  </verify>
  <done>CLI binary prints help text with all sections, --version shows 1.0.0, exit codes are 0, bin entry point is correctly wired.</done>
</task>

<task type="checkpoint:human-action" gate="blocking">
  <name>Task 4: Verify npm authentication</name>
  <action>
Claude will attempt to run `npm whoami` to check npm authentication status.

If `npm whoami` succeeds: display the username and ask for confirmation.
If `npm whoami` fails with ENEEDAUTH: present the checkpoint below.
  </action>
  <how-to-verify>
Run `npm whoami` in your terminal. If it returns your npm username, authentication is configured.

If it fails:
1. Run `npm login`
2. Enter your npm username, password, and email
3. Enter 2FA code if prompted
4. Verify with `npm whoami`
  </how-to-verify>
  <resume-signal>Confirm your npm username or type "authenticated" after running npm login</resume-signal>
  <done>npm whoami returns a valid npm username, confirming publish authentication is ready.</done>
</task>

</tasks>

<verification>
All four pre-publish criteria verified:
1. `npm test` exits 0 with 91 passing tests
2. `npm pack --dry-run` shows correct tarball contents (dist/, bin/, no node_modules/)
3. `node dist/cli.js --help` prints help text without error
4. `npm whoami` returns authenticated npm username
</verification>

<success_criteria>
- All 91 tests pass
- Build produces fresh dist/ output
- Tarball contains only intended files at version 1.0.0
- CLI binary executes correctly with --help and --version
- npm authentication is confirmed
- Package is ready for `npm publish` in Phase 8
</success_criteria>

<output>
After completion, create `.planning/phases/07-pre-publish-verification/07-01-SUMMARY.md`
</output>
